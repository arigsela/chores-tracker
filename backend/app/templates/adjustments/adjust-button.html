<!-- Adjustment button to show inline form -->
<button id="adjust-btn-{{ child.id }}"
        onclick="showAdjustmentForm({{ child.id }})"
        class="bg-purple-500 text-white px-3 py-1 rounded text-sm hover:bg-purple-600"
        title="Add bonus or deduction">
    Adjust Balance
</button>

<script>
    function showAdjustmentForm(childId) {
        // Hide the adjust button
        document.getElementById(`adjust-btn-${childId}`).style.display = 'none';
        
        // Show the adjustment form
        const formContainer = document.getElementById(`adjustment-form-${childId}`);
        if (formContainer) {
            formContainer.style.display = 'block';
        } else {
            // If form doesn't exist, load it via HTMX
            const targetRow = document.getElementById(`child-row-${childId}`);
            if (targetRow) {
                // Create a new row for the form
                const formRow = document.createElement('tr');
                formRow.id = `adjustment-row-${childId}`;
                formRow.innerHTML = '<td colspan="7" class="p-0"></td>';
                
                // Insert after the current row
                targetRow.parentNode.insertBefore(formRow, targetRow.nextSibling);
                
                // Load the form via HTMX
                htmx.ajax('GET', `/api/v1/html/adjustments/form/${childId}`, {
                    target: `#adjustment-row-${childId} td`,
                    swap: 'innerHTML'
                });
            }
        }
    }
</script>